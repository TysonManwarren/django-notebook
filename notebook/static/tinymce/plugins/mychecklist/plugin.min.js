(function () {
    var mychecklist = (function () {
        'use strict';
        tinymce.PluginManager.add("mychecklist", function (editor, url) {

            /**
             * Plugin behaviour for when the Toolbar or Menu item is selected
             *
             * @private
             */
            function _onAction()
            {
                var content = `<ul class="tox-checklist">
                    <li class="tox-checklist--checked">Task</li>
                    </ul>`;

                editor.insertContent(content);
            }

            // Define the Toolbar button
            editor.ui.registry.addButton('mychecklist', {
                icon: 'checklist',
                tooltip: 'Insert check list',
                onAction: _onAction
            });

            editor.on( 'Click', function ( event ) {

                var node = editor.selection.getNode();
                var parent = node.parentElement;

                if (parent.className === "tox-checklist") {
                    if ((node.nodeName === "LI") && (node.className === "tox-checklist--checked")) {
                        console.log("clear node classname");
                        node.className = "";
                    } else if ((node.nodeName === "LI") && (node.className === "")) {
                        console.log("set node classname to checked");
                        node.className = "tox-checklist--checked";
                    }
                }
            });


        });
    }());
})();